# Копируйте в .env и заполните значения

# База данных
DB_HOST=localhost
DB_NAME=sv
DB_USER=root
DB_PASSWORD=

# JWT
JWT_SECRET=your-secret-key-here
# Refresh token: sliding expiration (продление при каждом использовании)
# JWT_REFRESH_SLIDING_DAYS=365 — продлевать на год при каждом refresh
# JWT_REFRESH_MAX_AGE_DAYS=3650 — верхняя граница (10 лет)
# JWT_REFRESH_INITIAL_DAYS=3650 — срок при создании (логин)

# URL приложения (для ссылок в письмах)
APP_URL=https://s-vladimirov.ru

# Почта для сброса пароля (SMTP)
# Если MAIL_HOST и MAIL_USERNAME пустые — используется PHP mail()
# Roundcube на том же сервере → MAIL_HOST=localhost; иначе — хост из настроек SMTP Roundcube
MAIL_HOST=localhost
MAIL_PORT=587
MAIL_USERNAME=noreply@s-vladimirov.ru
MAIL_PASSWORD=
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@s-vladimirov.ru
MAIL_FROM_NAME=PlanRun
# Опционально: отключить проверку SSL (только для самоподписанных сертификатов на своём сервере)
# MAIL_VERIFY_PEER=0

# Чат: напрямую в LM Studio (127.0.0.1 надёжнее localhost)
LMSTUDIO_BASE_URL=http://127.0.0.1:1234/v1
LMSTUDIO_CHAT_MODEL=mistralai/ministral-3-14b-reasoning
CHAT_HISTORY_MESSAGES_LIMIT=100
CHAT_MAX_TOKENS=16384
# Суммаризация: при количестве сообщений > порога старые заменяются на summary
CHAT_SUMMARIZE_ENABLED=1
CHAT_SUMMARIZE_THRESHOLD=35
CHAT_RECENT_MESSAGES=15
CHAT_SEARCH_HISTORY=1
CHAT_RAG_ENABLED=1
# Tools (function calling): get_plan, get_workouts, get_day_details, update_training_day и др.
CHAT_TOOLS_ENABLED=1
# 0 = напрямую LM Studio (tools работают). 1 = через PlanRun AI (tools отключены)
CHAT_USE_PLANRUN_AI=0
# При ошибке LM Studio пробовать PlanRun AI /chat
CHAT_FALLBACK_TO_PLANRUN_AI=1

# Интеграции: Huawei Health Kit
# HUAWEI_HEALTH_CLIENT_ID=
# HUAWEI_HEALTH_CLIENT_SECRET=
# HUAWEI_HEALTH_REDIRECT_URI=https://your-domain.com/api/oauth_callback.php
# HUAWEI_HEALTH_SCOPES=https://www.huawei.com/healthkit/activity.read https://www.huawei.com/healthkit/historydata.open.month

# Интеграции: Polar AccessLink
# POLAR_CLIENT_ID=
# POLAR_CLIENT_SECRET=
# POLAR_REDIRECT_URI=https://your-domain.com/api/oauth_callback.php?provider=polar
# Регистрация: https://admin.polaraccesslink.com

# Интеграции: Strava API
# STRAVA_CLIENT_ID=
# STRAVA_CLIENT_SECRET=
# STRAVA_REDIRECT_URI=https://your-domain.com/api/oauth_callback.php?provider=strava
# STRAVA_PROXY= — опционально, для обхода блокировок (http://host:port или socks5://host:port)
# Webhook (автоматический импорт тренировок):
# STRAVA_WEBHOOK_CALLBACK_URL=https://your-domain.com/api/strava_webhook.php
# STRAVA_WEBHOOK_VERIFY_TOKEN=planrun_verify — произвольная строка для верификации
# Cron: проверка Strava каждые 4 ч (токены живут ~6 ч): 0 */4 * * * php .../scripts/strava_daily_health_check.php

# Push-уведомления (Firebase FCM)
# Путь к JSON сервисного аккаунта Firebase (Project Settings → Service Accounts → Generate new private key)
# FIREBASE_CREDENTIALS=config/firebase-credentials.json
# Или содержимое JSON в одной строке (для Docker/CI):
# FIREBASE_CREDENTIALS_JSON={"type":"service_account",...}

# RAG и генерация планов: PlanRun AI
PLANRUN_AI_API_URL=http://127.0.0.1:8000/api/v1/generate-plan
# RAG для чата (опционально): по умолчанию выводится из PLANRUN_AI_API_URL
# RAG_RETRIEVE_URL=http://127.0.0.1:8000/api/v1/retrieve-knowledge
